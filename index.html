<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Time Left Awake</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: transparent;
    margin: 0;
    padding: 16px;
    text-align: center;
  }

  .countdown {
    font-size: 48px;
    font-weight: 600;
    margin-bottom: 12px;
  }

  button {
    font-size: 12px;
    padding: 4px 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: white;
    cursor: pointer;
  }

  button:hover {
    background: #f2f2f2;
  }
</style>
</head>
<body>

<div class="countdown" id="timeLeft">--:--</div>
<button onclick="adjustBedtime()">Adjust Bedtime</button>

<script>
let bedtimeHour = 22;
let bedtimeMinute = 30;

const display = document.getElementById("timeLeft");

function getNextBedtime() {
  const now = new Date();
  const bedtime = new Date(now);
  bedtime.setHours(bedtimeHour, bedtimeMinute, 0, 0);

  // if bedtime already passed today, set for tomorrow
  if (now >= bedtime) bedtime.setDate(bedtime.getDate() + 1);

  return bedtime;
}

function updateCountdown() {
  const now = new Date();
  const target = getNextBedtime();
  const diffMs = target - now;

  const totalMinutes = Math.max(0, Math.floor(diffMs / 60000));
  const hours = Math.floor(totalMinutes / 60);
  const minutes = totalMinutes % 60;

  display.textContent = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}`;
}

// Manual adjustment button
function adjustBedtime() {
  const newTime = prompt("Enter today's bedtime (HH:MM 24-hour)", `${String(bedtimeHour).padStart(2,'0')}:${String(bedtimeMinute).padStart(2,'0')}`);
  if (!newTime) return;
  const [h, m] = newTime.split(":").map(Number);
  if (h >= 0 && h < 24 && m >= 0 && m < 60) {
    bedtimeHour = h;
    bedtimeMinute = m;
    updateCountdown();
  } else {
    alert("Invalid time entered.");
  }
}

// Start countdown interval
updateCountdown();
setInterval(updateCountdown, 60000); // update every minute
</script>

</body>
</html>
